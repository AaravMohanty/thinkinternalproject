<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="THINKedIn - PurdueTHINK Alumni Network">
    <title>THINKedIn - PurdueTHINK</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/global.css">
    <link rel="stylesheet" href="styles/people.css">
</head>
<body>
    <!-- Animated Background Elements -->
    <div class="background-container">
        <div class="liquid-shape liquid-shape-1"></div>
        <div class="liquid-shape liquid-shape-2"></div>
        <div class="liquid-shape liquid-shape-3"></div>
        <div class="radial-glow radial-glow-1"></div>
        <div class="radial-glow radial-glow-2"></div>
        <div class="radial-glow radial-glow-3"></div>
    </div>
    <!-- App Header -->
    <header class="app-header">
        <div class="header-content">
            <div class="header-left">
                <img src="assets/Copy of P logo for medium or dark background (1).png" alt="PurdueTHINK" class="logo">
                <h2 class="header-title">THINKedIn</h2>
            </div>
            <nav class="header-nav">
                <a href="home.html" class="nav-link active">Alumni</a>
                <div class="profile-dropdown" id="profileDropdown">
                    <button class="profile-avatar-btn" id="profileAvatarBtn">
                        <img src="" alt="Profile" class="profile-avatar-img" id="profileAvatarImg" style="display: none;">
                        <span class="profile-avatar-initials" id="profileAvatarInitials">U</span>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <a href="profile.html" class="dropdown-item">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            Profile
                        </a>
                        <button class="dropdown-item" id="logoutLink">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <h1 class="hero-title">DISCOVER YOUR<br>ALUMNI NETWORK</h1>
            <p class="hero-subtitle">Connect with PurdueTHINK alumni shaping the future across industries, roles, and innovations</p>
            <div class="hero-cta">
                <button class="cta-button" onclick="document.getElementById('searchName').focus()">
                    Explore Alumni
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="alumni-finder-wrapper">
        <div class="container-wide">
            <div class="alumni-layout">
                <!-- Sidebar Filters -->
                <aside class="filters-sidebar" id="filtersSidebar">
                    <div class="filters-header">
                        <h2>Filters</h2>
                        <button class="btn-reset" id="resetFilters">Reset All</button>
                    </div>

                    <div class="filter-group">
                        <label for="searchName">Search by Name</label>
                        <input
                            type="text"
                            id="searchName"
                            class="filter-input"
                            placeholder="e.g., John, Smith">
                    </div>

                    <div class="filter-group">
                        <label for="searchTitle">Job Title</label>
                        <input
                            type="text"
                            id="searchTitle"
                            class="filter-input"
                            placeholder="e.g., software, analyst">
                    </div>

                    <div class="filter-group">
                        <label for="filterMajor">Major</label>
                        <input type="text" class="filter-search" id="searchMajor" placeholder="Search majors...">
                        <select id="filterMajor" class="filter-select" multiple>
                            <option value="">Loading...</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="filterYear">Graduation Year</label>
                        <input type="text" class="filter-search" id="searchYear" placeholder="Search years...">
                        <select id="filterYear" class="filter-select" multiple>
                            <option value="">Loading...</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="filterCompany">Company</label>
                        <input type="text" class="filter-search" id="searchCompany" placeholder="Search companies...">
                        <select id="filterCompany" class="filter-select" multiple>
                            <option value="">Loading...</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="filterIndustry">Industry</label>
                        <input type="text" class="filter-search" id="searchIndustry" placeholder="Search industries...">
                        <select id="filterIndustry" class="filter-select" multiple>
                            <option value="">Loading...</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="sortBy">Sort By</label>
                        <select id="sortBy" class="filter-select">
                            <option value="name">Name</option>
                            <option value="company">Company</option>
                            <option value="grad_year">Graduation Year</option>
                            <option value="major">Major</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="sortAscending" checked>
                            <span>Ascending Order</span>
                        </label>
                    </div>
                </aside>

                <!-- Alumni Grid -->
                <main class="alumni-content">
                    <div class="alumni-controls">
                        <button class="btn-toggle-filters" id="toggleFilters">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/>
                            </svg>
                            Filters
                        </button>
                        <div class="results-count">
                            <span id="resultsCount">Loading...</span>
                        </div>
                    </div>

                    <div id="loadingSpinner" class="loading-spinner">
                        <div class="spinner"></div>
                        <p>Loading alumni data...</p>
                    </div>

                    <div id="alumniGrid" class="alumni-grid">
                        <!-- Alumni cards will be dynamically inserted here -->
                    </div>

                    <div id="noResults" class="no-results" style="display: none;">
                        <svg width="64" height="64" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                        </svg>
                        <h3>No results found</h3>
                        <p>Try adjusting your filters or search terms</p>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <h3 class="footer-brand">PurdueTHINK</h3>
            <p class="copyright">Â© PurdueTHINK 2025</p>
        </div>
    </footer>

    <script src="scripts/auth.js"></script>
    <script src="scripts/main.js"></script>
    <script src="scripts/alumni.js"></script>
    <script>
        // Check authentication on page load
        if (!Auth.isAuthenticated()) {
            window.location.href = 'login.html';
        }

        // Load user profile for avatar
        async function loadUserAvatar() {
            const userData = Auth.getUserData();
            if (userData) {
                updateAvatar(userData);
            }

            // Also try to get fresh data from server
            const user = await Auth.init();
            if (user) {
                updateAvatar(user);
            }
        }

        function updateAvatar(userData) {
            const avatarImg = document.getElementById('profileAvatarImg');
            const avatarInitials = document.getElementById('profileAvatarInitials');

            if (userData.profile_image_url) {
                avatarImg.src = userData.profile_image_url;
                avatarImg.style.display = 'block';
                avatarInitials.style.display = 'none';
            } else {
                const name = userData.full_name || userData.profile?.full_name || 'User';
                const initials = name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                avatarInitials.textContent = initials || 'U';
                avatarImg.style.display = 'none';
                avatarInitials.style.display = 'flex';
            }
        }

        // Profile dropdown toggle
        const profileDropdown = document.getElementById('profileDropdown');
        const profileAvatarBtn = document.getElementById('profileAvatarBtn');
        const dropdownMenu = document.getElementById('dropdownMenu');

        profileAvatarBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            profileDropdown.classList.toggle('open');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!profileDropdown.contains(e.target)) {
                profileDropdown.classList.remove('open');
            }
        });

        // Close dropdown on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                profileDropdown.classList.remove('open');
            }
        });

        // Logout handler
        document.getElementById('logoutLink').addEventListener('click', (e) => {
            e.preventDefault();
            Auth.logout();
        });

        // Load avatar on page load
        loadUserAvatar();
    </script>
</body>
</html>
